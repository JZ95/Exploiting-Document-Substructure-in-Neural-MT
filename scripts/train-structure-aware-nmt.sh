#!/bin/sh
source ./vars
script_dir=`dirname $0`
src_dir=$script_dir/../src
data_dir=$data_dir/p-tag
model_dir=$script_dir/models

CUDA_VISIBLE_DEVICES=0,1,2,3 $src_dir/train.py \
    --mode nmt \
    --batch_size 16 \
    --model $ckpt_dir/structure-nmt \
    --dictionaries $model_dir/vocab.zh.json $model_dir/vocab.en.json \
    --datasets $data_dir/corpus.p_tag.zh $data_dir/corpus.p_tag.en \
    --valid_datasets $data_dir/dev.p_tag.zh $data_dir/dev.p_tag.en \
    --valid_script ./valid-nmt.sh \
    --valid_batch_size 16 \
    --valid_freq 20000 \
    --disp_freq 1000 \
    --sample_freq 40000 \
    --save_freq 40000 \
    --embedding_size 500 \
    --maxlen_word 60 \
    --maxlen_sent 20 \
    --word_rnn_enc_transition_depth 2 \
    --word_rnn_state_size 512 \
    --sent_rnn_state_size 256 \
    --sec_repr_size 256 \
    --tie_decoder_embeddings \
    --rnn_layer_normalisation \
    --keep_train_set_in_memory
