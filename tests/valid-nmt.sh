#!/bin/sh
# helper valid script for test-train-nmt.sh

test_dir=`dirname $0`
ref=$test_dir/data/valid-nmt.ref.en
util_dir=$test_dir/../utils
translations=$1

cat $translations | \
$util_dir/detruecase.perl | \
$util_dir/detokenizer.perl -l en | \
grep -v '^\(<p>\)\|\(</p>\)$' > tmp.trans.txt   # rm p-tag

grep -v '^\(<p>\)\|\(</p>\)$' $ref > tmp.ref.txt  # rm p-tag

$util_dir/multi-bleu-detok.perl tmp.ref.txt <  tmp.trans.txt | \
cut -f 3 -d ' ' | \
cut -f 1 -d ',' 

rm tmp.trans.txt
rm tmp.ref.txt